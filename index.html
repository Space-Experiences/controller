<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="viewport" content="width=device-width, user-scalable=no" />
  <link rel="manifest" href="manifest.json" />

    <title>Portal</title>

    <link rel="stylesheet" href="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
   <script src="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/&#10;css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en"> <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
    <link rel="stylesheet" href="css/stylesheet.css">

<body class="top-bar-menu top-bar-back top-bar-neutral">
  <header class=" mdc-top-app-bar mdc-top-app-bar--fixed app-top-bar" data-mdc-auto-init="MDCTopAppBar">
    <div class="mdc-top-app-bar__row">
      <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
        <button class="material-icons mdc-top-app-bar__navigation-icon--unbounded" id="top-app-btn-back">keyboard_arrow_left</button>
        <button class="material-icons mdc-top-app-bar__navigation-icon--unbounded" id="top-app-btn-menu">menu</button>
        <span class="mdc-top-app-bar__title top-app-bar-title"></span> </section>
      <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end">
        <button class="material-icons mdc-top-app-bar__action-item--unbounded" id="toggle-lock-state-btn" style="opacity:0;" aria-label="lock"><i class="material-icons">lock</i></button>
      </section>
    </div>
</header>

    <div class="main nav-disabled" active-screen="home">




        <!-- Sections are seperate screens -->


            <!-- screen -->

            <!--
            <div class="screen disabled enabled" data-name="REPLACEME">
                    <div class="mdc-layout-grid mdc-layout-grid__cell--span-12">
                      <div class="mdc-layout-grid__inner">
                        <div class="mdc-layout-grid__cell"></div>
                        <div class="mdc-layout-grid__cell"></div>
                        <div class="mdc-layout-grid__cell"></div>
                      </div>
                      </div>
            </div>
            -->

              <!-- loading screen -->
              <div class="screen disabled enabled" style="opacity:1;" data-name="loading">
                <div class="screen_inner">
                <div class="loading-visual"><img src="images/loadingblob.gif"></div>
              </div><!-- End screen_inner -->
              </div><!-- End screen -->


              <div class="screen disabled" data-name="home" data-screen-title="Portal">
                <div class="screen_inner">

                  <!-- portal state information -->
                  <div class="portal-display">
                    <div class="portal-display_inner">
                      <div class="pd-info" name="state"></div>
                      <div class="pd-info" name="classID"></div>
                      <div class="pd-info" name="classDuration"></div>
                      <div class="pd-info" name="classProgress"></div>
                      <div class="pd-info" name="nextClassCountdown"></div>
                    </div>
                    <div class="load-class-progress not-active active">
                      <div role="progressbar" data-mdc-auto-init="MDCLinearProgress" class="mdc-linear-progress">
                    <div class="mdc-linear-progress__buffering-dots"></div>
                    <div class="mdc-linear-progress__buffer"></div>
                    <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                      <span class="mdc-linear-progress__bar-inner"></span>
                    </div>
                    <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                      <span class="mdc-linear-progress__bar-inner"></span>
                    </div>
                  </div>
                    </div>

                  </div>

                  <!-- live portal controls -->
                      <div class="portal-live-controls" style="display:none;">

                    <button class="mdc-button mdc-button--raised"   data-value="Start Class" data-type="pusher" class="mdc-button"   data-mdc-auto-init="MDCRipple" id="start-class-btn">Start</button>

                    <!--<div data-type="pusher" class="mdc-button"  data-value="Start in 10 Seconds" id="start-delay-btn">Start in 10 seconds</button>-->
                    <div class="mdc-select"   id="start-delay-btn">
                      <input type="hidden" name="enhanced-select" id="delay-select-val" >
                       <i class="mdc-select__dropdown-icon"></i>
                       <div class="mdc-select__selected-text" tabindex="0" aria-selected="true" role="option" data-value="0"></div>
                       <div class="mdc-select__menu mdc-menu mdc-menu-surface demo-width-class">
                         <ul class="mdc-list">
                           <li class="mdc-list-item mdc-list-item--selected" data-value="0" aria-selected="true">--</li>
                           <li class="mdc-list-item" data-value="0">
                             --
                           </li>
                           <li class="mdc-list-item" data-value="10">
                             10 sec.
                           </li>
                           <li class="mdc-list-item" data-value="20">
                             20 sec.
                           </li>
                           <li class="mdc-list-item" data-value="60">
                             1 min.
                           </li>
                         </ul>
                       </div>
                       <span class="mdc-floating-label">start delay</span>
                       <div class="mdc-line-ripple"></div>
                     </div>
                    <button  class="mdc-button mdc-button--raised"   data-value="Pause Class" data-type="pusher" class="mdc-button"   data-mdc-auto-init="MDCRipple" id="pause-class-btn" style="display:none;">Pause</button>


                      </div>
                      <div class="visual" id="delay-countdown">
                        <div id="delay-countdown_inner">
                          <div id="runner">0.00</div>
                        <button  class="mdc-button mdc-button--raised"   data-value="cancelDelayToStartClass" data-type="pusher" class="mdc-button"   data-mdc-auto-init="MDCRipple" id="cancel-start-class-delay-btn">cancel</button>

                      </div>

                            <div id="delay-countdown-graphic"></div>
                    </div>



                </div><!-- End screen_inner -->
              </div><!-- End screen -->

              <div class="screen disabled" data-name="list" data-screen-title="Classes">
                <div class="screen_inner">
                      <div class="mdc-layout-grid mdc-layout-grid__cell--span-12">
                        <div class="mdc-layout-grid__inner">
                          <div class="mdc-layout-grid__cell--span-12 class-list">
                            <div id="class-list"></div>
                            <button data-type="pusher" class="mdc-button" data-type="pusher" data-value="Prepare Class B101">B101</button>
                            <button data-type="pusher" class="mdc-button" data-value="Prepare Class B102">B102</button>
                            <button data-type="pusher" class="mdc-button" data-value="Prepare Class B103">B103</button>
                            <button data-type="pusher" class="mdc-button" data-value="Prepare Class B104">B104</button>
                            <button data-type="pusher" class="mdc-button" data-value="Prepare Class B105">B105</button>
                            <button data-type="pusher" class="mdc-button" data-value="Prepare Class B106">B106</button>
                            <button data-type="pusher" class="mdc-button" data-value="Prepare Class B109">B109</button>
                            <button data-type="pusher" class="mdc-button" data-value="Prepare Class B110">B110</button>
                              <button data-type="pusher" class="mdc-button" data-value="Prepare Class B333">B333</button>
                          </div>
                          <br>
                          <br>
                        </div>
                        </div>
              </div><!-- End screen_inner -->
            </div><!-- End screen -->





            <div class="full-card-overlay"></div>
            <div class="full-card" class-id="none">
              <div class="full-card_inner">
                <div class="mdc-typography full-card_content">
                  <h2 class="mdc-typography--headline4 data-info" info="classID"></h2>

                  <p class="mdc-typography--subtitle1 data-info" info="instructorName"></p>
                  <div class="info-box">
                    <div class="one mdc-typography--overline label" >Duration</div>
                    <div class="two mdc-typography--overline label" >Rating</div>
                    <div class="three mdc-typography--overline label">Status</div>
                  </div>
                  <div class="info-box">
                    <div class="one mdc-typography--caption data-info" info="duration">One</div>
                    <div class="two mdc-typography--caption data-info" info="rating">Two</div>
                    <div class="three mdc-typography--caption data-info" info="status">Three</div>
                  </div>
                  <!--<p class="mdc-typography--subtitle1 data-info" info="duration"></p>
                  <p class="mdc-typography--subtitle1 data-info" info="status"></p>
                  <p class="mdc-typography--subtitle1 data-info" info="rating"></p>-->
                  <p class="mdc-typography--subtitle1 data-info" info="intention"></p>
                  <p class="mdc-typography--subtitle1 data-info" info="description"></p>

                  <br>
                  <br>
                  <br>

                </div>
                <div class="full-card_actions">
                  <button class="mdc-button mdc-button--raised start-button" data-mdc-auto-init="MDCRipple">Load Class</button>
                  <button class="mdc-button  schedule-button"  data-mdc-auto-init="MDCRipple">Schedule</button>

                </div>
              </div>

            </div>


<!-- End screens -->
          <!-- Screen navigation -->
            <div class="navigation">
              <div class="mdc-tab-bar" data-mdc-auto-init="MDCTabBar"  role="tablist">
              <div class="mdc-tab-scroller">
                <div class="mdc-tab-scroller__scroll-area">
                  <div class="mdc-tab-scroller__scroll-content">
                    <!-- Nav tab -->
                    <button class="mdc-tab mdc-tab--active nav-btn" role="tab" data-name="home"  aria-selected="true" tabindex="0">
                      <span class="mdc-tab__content">
                          <span class="mdc-tab__icon material-icons" aria-hidden="true">assessment</span>
                        <span class="mdc-tab__text-label"></span>
                      </span>
                      <span class="mdc-tab-indicator mdc-tab-indicator--active">
                        <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
                      </span>
                      <span class="mdc-tab__ripple"></span>
                    </button>

                    <!-- Nav tab -->
                    <button class="mdc-tab  nav-btn" role="tab" aria-selected="false" data-name="list" data-screen-name="Classes" tabindex="1">
                      <span class="mdc-tab__content">
                        <span class="mdc-tab__icon material-icons" aria-hidden="true">list</span>
                        <span class="mdc-tab__text-label"></span>
                      </span>
                      <span class="mdc-tab-indicator">
                        <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
                      </span>
                      <span class="mdc-tab__ripple"></span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            </div>


            <div class="climate-display" style="   transform: matrix(1, 0, 0, 1, 0, -50);" >
              <div class="climate-info farenheight"><span class="climate-data" climate-info-type="current" climate-name="f" id="current-farenheight"></span><span class="climate-icon" name="f">F</span></div>
              <div  class="climate-info humidity" ><span class="climate-data" climate-info-type="current" climate-name="h" id="current-humidity"></span><span class="climate-icon" name="h">%</span></div>
            </div>


          <div class="climate-card">
            <div class="mdc-typography">

                              <p class="mdc-typography--subtitle1 data-info" >climate</p>
                              <div class="wrapper">
  <div class="box a">
           <div class="climate-info farenheight"><span class="climate-data" climate-info-type="current" climate-name="f" ></span>
             <span class="climate-icon" name="f">F</span>
    <div class="three mdc-typography--overline label">temperature</div>
           </div>
         </div>
  <div class="box b"><div  class="climate-info humidity" ><span class="climate-data" climate-info-type="current" climate-name="h" ></span><span class="climate-icon" name="h">%</span>

  <div class="three mdc-typography--overline label">humidity</div>
  </div>
</div>
  <div class="box e">

<!-- Temp control slider -->

    <div id="knob-container" >
      <div id="current-temp-knob" class="knob"><span>|</span></div>
      <div id="control-knob" class="knob"><span>|</span></div>

      <div id="set-temp-to" class="climate-data" climate-info-type="current" climate-name="setTemp">--</div></div>
  </div>
  <div class="box f">
<div class="three mdc-typography--overline label">temperature control:</div>
    <div class="mdc-slider mdc-slider--discrete mdc-slider--display-markers" id="set-temp-slider" tabindex="0" role="slider"
         aria-valuemin="50" aria-valuemax="90" aria-valuenow="50"
         data-step="1" aria-label="Select Value">
         <div class="mdc-slider__track-container">
          <div class="mdc-slider__track"></div>
          <div class="mdc-slider__track-marker-container"></div>
        </div>

 <div class="mdc-slider__track-container">
   <div class="mdc-slider__track"></div>
 </div>
 <div class="mdc-slider__thumb-container">
   <div class="mdc-slider__pin">
     <span class="mdc-slider__pin-value-marker"></span>
   </div>
   <svg class="mdc-slider__thumb" width="21" height="21">
     <circle cx="10.5" cy="10.5" r="7.875"></circle>
   </svg>
   <div class="mdc-slider__focus-ring"></div>
 </div>
</div>

  </div>

  <!-- temp chart -->
  <div class="box g">
    <div class="ct-chart ct-perfect-fourth"></div>
  </div>
  <!-- end temp chart -->

</div>
                              <div class="climate-card-info" style="opacity: 0;transform: matrix(0, 0, 0, 0, 0, 0);" >
                                <div class="climate-info farenheight">
                                  <span class="climate-data" climate-info-type="current" climate-name="f" ></span>
                                  <span class="climate-icon" name="f">F</span>

                                </div>
                                <div  class="climate-info humidity" >
                                  <span class="climate-data" climate-info-type="current" climate-name="h" ></span>
                                  <span class="climate-icon" name="h">%</span>

                                </div>
                              </div>

                              <br>
                              <br>
                              <br>

          </div>
          </div>



<!-- close main -->
    </div><!-- end main -->



    <!-- notification snackbars -->
    <div class="mdc-snackbar" id="primary-snackbar">
      <div class="mdc-snackbar__surface">
        <div class="mdc-snackbar__label"
             role="status"
             aria-live="polite">
          Message text.
        </div>
        <div class="mdc-snackbar__actions" style="display:none;">
          <button type="button" class="mdc-button mdc-snackbar__action">Label</button>
        </div>
        <button class="mdc-icon-button mdc-snackbar__dismiss material-icons" title="Dismiss">close</button>
      </div>
    </div>
    <!-- end notification snackbar -->

</body>

<script src="jquery-slim.js"></script>
<script src="js/jquery.runner-min.js"></script>
<script src="greensock-business/src/minified/TweenMax.min.js" type="text/javascript"></script>
<script src="greensock-business/src/minified/TimelineMax.min.js"></script>
<script src="greensock-business/src/minified/utils/Draggable.min.js"></script>
<script src="greensock-business/src/minified/plugins/ThrowPropsPlugin.min.js"></script>
<script src="greensock-business/src/minified/utils/GSDevTools.min.js"></script>
<script src="greensock-business/src/minified/jquery.gsap.min.js"></script>
<script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>


<script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
<script>


var windowParams = {
  height:$(window).height(),
  width:$(window).width()
};

$(window).resize(function(){
  windowParams = {
    height:$(window).height(),
    width:$(window).width()
  };
  console.log('resize event');
})

// Helpers
// Generate random short uid.
function genUid(len = 10) {
   if (len > 16) { // Cap uid length to max number that can be returned.
      len = 16;
   }
   return Math.random().toString(30).substr(2, 2 + len); // Generate random num. and get numbers after decimal point
}

// convert seconds (duration from file or wavesurger) into hh:mm:ss,ms
function sec2time(timeInSeconds,formatType = 'custom-default') {
    var pad = function(num, size) { return ('000' + num).slice(size * -1); },
    time = parseFloat(timeInSeconds).toFixed(3),
    hours = Math.floor(time / 60 / 60),
    minutes = Math.floor(time / 60) % 60,
    seconds = Math.floor(time - minutes * 60),
    milliseconds = time.slice(-3);

    if(formatType == 'custom-default'){
      return pad(minutes, 2) + ':' + pad(seconds, 2);

    }
     if(formatType == 'hh:mm:ss'){
          return pad(hours, 2) + ':' +pad(minutes, 2) + ':' + pad(seconds, 2);

    }
    if(formatType == 'm:ss'){
              return pad(minutes, 1) + ':' + pad(seconds, 2);
      }
    if(formatType == 'seconds'){
              return pad(seconds, 2);
      }
  else{
      return pad(minutes, 2) + ':' + pad(seconds, 2) + ',' + pad(milliseconds, 3);
  }
}


/*=================================================================
=             Get position of element relative to page            =
=================================================================*/

var getAbsPosition = function(el){ // returns [TOP,LEFT] <-- access by array
    var el2 = el;
    var curtop = 0;
    var curleft = 0;
    if (document.getElementById || document.all) {
        do  {
            curleft += el.offsetLeft-el.scrollLeft;
            curtop += el.offsetTop-el.scrollTop;
            el = el.offsetParent;
            el2 = el2.parentNode;
            while (el2 != el) {
                curleft -= el2.scrollLeft;
                curtop -= el2.scrollTop;
                el2 = el2.parentNode;
            }
        } while (el.offsetParent);

    } else if (document.layers) {
        curtop += el.y;
        curleft += el.x;
    }
    return {top:curtop, left:curleft};
};

/*=====  End of   Get position of element relative to page  ======*/


/*----------    Convert number to pixels  ----------*/
function px(number){
    number = String(number) + "px";
    return number;
}

</script>
<script src="js/information-manager.js"></script>
<script src="js/socket-manager.js"></script>
<script src="js/orchestrator.js"></script>

  <script>

navigator.serviceWorker && navigator.serviceWorker.register('./sw.js').then(function(registration) {
  console.log('Excellent, registered with scope: ', registration.scope);
});
   </script>

<script>

</script>




<div class="pusher-socket">
   <script src="https://js.pusher.com/4.4/pusher.min.js"></script>
</div>
  <script>

/* Working client connection to heroku server for websocket client authentication */
  // Enable pusher logging - don't include this in production

    // Parse incoming messages from pusher socket.
    var classData = [];
    var portalState = {
      state:"...", // loadingClass,classReady,liveClass,standby,enterClass,exitClass,cleanMode,
      classID:" ", // classID in airtable and production folder
      classDuration:"...", // Total length of class if one is loaded or live
      classProgress:"...", // percentage complete for class (calculated on client side for time)
      nextClassCountdown:"...", // If class is about to start, how much time until next class
      classSchedule:[], // Schedule of upcoming classes
      climate:{f:0,h:0,setTemp:0}
    };
    var socketManager = new SocketManager();

    var psm = new PortalStateView();


    // Manage pub sub events.

    var EventBus = {};
    (function(q) {
        var topics = {}, subUid = -1;
        q.subscribe = function(topic, func) {
            if (!topics[topic]) {
                topics[topic] = [];
            }
            var token = (++subUid).toString();
            topics[topic].push({
                token: token,
                func: func
            });
            return token;
        };

        q.publish = function(topic, args) {
            if (!topics[topic]) {
                return false;
            }
            setTimeout(function() {
                var subscribers = topics[topic],
                    len = subscribers ? subscribers.length : 0;

                while (len--) {
                    subscribers[len].func(topic, args);
                }
            }, 0);
            return true;

        };

        q.unsubscribe = function(token) {
            for (var m in topics) {
                if (topics[m]) {
                    for (var i = 0, j = topics[m].length; i < j; i++) {
                        if (topics[m][i].token === token) {
                            topics[m].splice(i, 1);
                            return token;
                        }
                    }
                }
            }
            return false;
        };
    }(EventBus));


    /* Working
    var EventBus = {
      topics: {},

      subscribe: function(topic, listener) {
        console.log('sub:' + topic);
        // create the topic if not yet created
        if(!this.topics[topic]) this.topics[topic] = [];

        // add the listener
        this.topics[topic].push(listener);
      },

      publish: function(topic, data) {
          console.log('pub:' + topic);
        // return if the topic doesn't exist, or there are no listeners
        if(!this.topics[topic] || this.topics[topic].length < 1) return;

        // send the event to all listeners
        this.topics[topic].forEach(function(listener) {
          listener(data || {});
        });
      }
    };

*/

     Pusher.logToConsole = true;

     var pusher = new Pusher('d698d9aba463d53b13b5', {
       cluster: 'us3',
       forceTLS: true,
        authEndpoint: 'https://portalwebsocket.herokuapp.com/pusher/auth' // Custom heroku websocket authentication endpoint
     });

     var channel = pusher.subscribe('private-channel');


          var firstLoadTimeout = setTimeout(function(){
                 offlineStatus();
                  showScreen('home','Portal');
                  setTimeout(function(){
                  toggleClimateDisplay(false);
                },500);
           },6000);


     channel.bind('pusher:subscription_succeeded', function() {
       // Indicate controller is on
       //channel.trigger('client-event', {type:"status",id:"controller"});

        psm.returnPortalState();

        // Sub to returned portal state.

        var firstListen = EventBus.subscribe('responsePortalState', function(){

          clearTimeout(firstLoadTimeout);

          firstLoad();

          channel.trigger('client-event', {eventType:'GET',
                                           value:'returnAirtableClassData',
                                           params:{classID:'--',
                                           startTime:'now'}});



                            //loadComplete = true;

          EventBus.unsubscribe(firstListen);



        });




     });



     function firstLoad(){
      clearTimeout(firstLoadTimeout);
       $(document).ready(function(){

         // Get the



         setTimeout(function(){
           showScreen('home','Portal');

           if(portalState.state != 'liveClass'){

         }
         setTimeout(function(){
           pageLoaded = true;
              if(portalState.state != 'classReady'){
                if(portalState.state == 'loadingClass'){
                  listenForTouchDuringLiveClass();
                }else{
                  if(portalState.state != 'liveClass'){
                  toggleNavigation(true);
                }
                }
              }else{
                  listenForTouchDuringLiveClass();
              }
          },1000);

       },0000);


         $('#toggle-lock-state-btn').click(function(){
            window.location.reload(true);
         });

       });
     }


     channel.bind('portal-event', function(msg) {
       socketManager.parsePortalEvent(msg);
     });




     $('button').click(function(){

       var val = $(this).attr('data-value');
       var type = $(this).attr('data-type');
       if(type == 'pusher'){

          channel.trigger('client-event', { type: 'pusher', value: val });
       }

     });

     $('.nav-btn').click(function(){
       var sectionName = $(this).attr('data-name');
       showScreen(sectionName);
     });



     var pageLoaded = false;


   </script>

   <script>
   //const select = new MDCSelect(document.querySelector('.mdc-select'));

var delaySelect = mdc.select.MDCSelect.attachTo(document.querySelector('.mdc-select'));
 mdc.autoInit();


 var loadProgressBar = mdc.linearProgress.MDCLinearProgress.attachTo(document.querySelector('.mdc-linear-progress'));
loadProgressBar.initialize();
loadProgressBar.close();






 /*
 * Snackbar notifications
 */

   var snackbar = mdc.snackbar.MDCSnackbar.attachTo(document.querySelector('.mdc-snackbar'));

 var elemSnackbarInner = $('.mdc-snackbar .mdc-snackbar__surface');
 var keepBarOpenInterval;
 function notification(snackbarText = 'Done.',type = 'default',closeInMs = 1500,hideButton = false){

   clearInterval(keepBarOpenInterval);
   snackbar.close();

   snackbar.labelText = snackbarText;
   elemSnackbarInner.removeClass(['error','success','default']);
   elemSnackbarInner.addClass(type);


   snackbar.open();

   if(closeInMs > 10000){

    keepBarOpenInterval = setInterval(function () {
      snackbar.open();
      console.log('keepBarOpenInterval...');
    }, 5000);

   }
   setTimeout(function(){

     clearInterval(keepBarOpenInterval);
     snackbar.close();

   },closeInMs)

 }
   </script>


   <script>

   function changeDelayStartTime(){
     var startBtn = $('#start-class-btn');

     var startBtnValue = 'Start Class';
        var delay = $('#delay-select-val').val();

        if(delay == 0){
          countdown.setStartTime(0);
        }
        if(delay == '10'){
          startBtnValue = 'Start Class in 10 seconds';
          countdown.setStartTime(10);
        }

        if(delay == '20'){
          startBtnValue = 'Start Class in 20 seconds';
          countdown.setStartTime(20);
        }
        if(delay == '60'){
          startBtnValue = 'Start Class in 60 seconds';
          countdown.setStartTime(60);
        }
          $(startBtn).attr('data-value',startBtnValue);
        //  $(startBtn).text(startBtnValue);
   }
   delaySelect.listen('MDCSelect:change', changeDelayStartTime);




function offlineStatus(callback = false){

  toggleNavigation(true);

 notification('The portal cortex is offline.','error',100000);

 toggleClimateDisplay(false);

  var confirmCallback =  EventBus.subscribe('responsePortalState', function(){

    notification('Conencted to the Portal.','success');
    toggleClimateDisplay(true);

      if(callback){
        callback();
      }
        EventBus.unsubscribe(confirmCallback);
    });
}
</script>


</html>
